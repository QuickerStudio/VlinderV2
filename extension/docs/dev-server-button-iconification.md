# âœ… Dev Server æŒ‰é’®å›¾æ ‡åŒ–æ”¹è¿›å®Œæˆ

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

å°† Dev Server å·¥å…·çš„ `Run Server` å’Œ `Cancel` æŒ‰é’®ä»è¾“å…¥åŒºåŸŸåº•éƒ¨ç§»åŠ¨åˆ° Dev Server ToolBlock çš„å³ä¾§ï¼Œå¹¶æ”¹ä¸ºå›¾æ ‡æ˜¾ç¤ºï¼Œå®ç°æ›´ç´§å‡‘å’Œç»Ÿä¸€çš„ç”¨æˆ·ç•Œé¢ã€‚

## ğŸ¯ æ”¹è¿›ç›®æ ‡

- **ç©ºé—´ä¼˜åŒ–**: å‡å°‘ç•Œé¢å†—ä½™ï¼Œå°†ç›¸å…³æ“ä½œé›†ä¸­åœ¨ä¸€å¤„
- **è§†è§‰ç»Ÿä¸€**: å›¾æ ‡æŒ‰é’®ä¸ ToolBlock è®¾è®¡é£æ ¼ä¿æŒä¸€è‡´
- **é€»è¾‘æ¸…æ™°**: å·¥å…·æ“ä½œæŒ‰é’®ç›´æ¥é›†æˆåœ¨å·¥å…·æœ¬èº«ä¸Š
- **ä»£æ›¿å…³ç³»**: æ˜ç¡®çš„ä»£æ›¿è€Œéå…±å­˜ï¼Œé¿å…é‡å¤æŒ‰é’®

## ğŸ”§ æŠ€æœ¯å®ç°

### 1. æ‰©å±• ToolBlock ç»„ä»¶

**æ–‡ä»¶**: `webview-ui-vite/src/components/chat-row/chat-tools.tsx`

#### 1.1 æ·»åŠ  customActions å±æ€§

```typescript
type ToolBlockProps = {
  // ... å…¶ä»–å±æ€§
  customActions?: React.ReactNode // ğŸ¯ æ–°å¢ï¼šè‡ªå®šä¹‰æ“ä½œæŒ‰é’®
} & ToolAddons
```

#### 1.2 åœ¨å³ä¾§åŒºåŸŸæ¸²æŸ“è‡ªå®šä¹‰æ“ä½œ

```typescript
{/* ğŸ¯ è‡ªå®šä¹‰æ“ä½œæŒ‰é’® */}
{customActions && (
  <div onClick={(e) => e.stopPropagation()}>
    {customActions}
  </div>
)}
```

### 2. ä¿®æ”¹ DevServerToolBlock ç»„ä»¶

#### 2.1 å®ç°è‡ªå®šä¹‰æ“ä½œæŒ‰é’®

```typescript
// ğŸ¯ è‡ªå®šä¹‰å³ä¾§æ“ä½œæŒ‰é’®åŒºåŸŸ
const renderActionButtons = () => {
  if (approvalState === "pending") {
    return (
      <div className="flex items-center space-x-2">
        {/* Run Server å›¾æ ‡æŒ‰é’® */}
        <Button
          size="sm"
          variant="default"
          className="h-8 w-8 p-0"
          onClick={() => {
            vscode.postMessage({
              type: "askResponse",
              askResponse: "yesButtonTapped",
              text: "",
              images: []
            })
          }}
          title="Run Server"
        >
          <Play className="h-4 w-4" />
        </Button>
        
        {/* Cancel å›¾æ ‡æŒ‰é’® */}
        <Button
          size="sm"
          variant="outline"
          className="h-8 w-8 p-0"
          onClick={() => {
            vscode.postMessage({
              type: "askResponse",
              askResponse: "noButtonTapped",
              text: "",
              images: []
            })
          }}
          title="Cancel"
        >
          <X className="h-4 w-4" />
        </Button>
      </div>
    )
  }
  return null
}
```

### 3. ä¿®æ”¹ ButtonSection ç»„ä»¶

**æ–‡ä»¶**: `webview-ui-vite/src/components/chat-view/button-section.tsx`

```typescript
/**
 * æ¸²æŸ“é€»è¾‘ 4ï¼šæ’é™¤ Dev Server ç›¸å…³æŒ‰é’®
 * Dev Server çš„ Run Server å’Œ Cancel æŒ‰é’®å·²ç»è¢« ToolBlock ä»£æ›¿
 */
if (primaryButtonText?.includes("Run Server") || secondaryButtonText?.includes("Run Server")) {
  return null // ğŸ¯ Dev Server æŒ‰é’®å·²è¢« ToolBlock ä»£æ›¿ï¼Œä¸åœ¨è¾“å…¥åŒºåŸŸæ˜¾ç¤º
}
```

## ğŸ¨ è§†è§‰æ•ˆæœå¯¹æ¯”

### ä¿®æ”¹å‰
```
ğŸ”µ Dev Server - webview-ui                              âœ… â–¼

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ $ npm run dev                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[è¾“å…¥åŒºåŸŸåº•éƒ¨]
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Run Server  â”‚ â”‚   Cancel    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä¿®æ”¹å
```
ğŸ”µ Dev Server - webview-ui                    â–¶ âŒ âœ… â–¼

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ $ npm run dev                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[è¾“å…¥åŒºåŸŸåº•éƒ¨ - å¹²å‡€æ•´æ´ï¼Œæ²¡æœ‰ Dev Server æŒ‰é’®]
```

## ğŸš€ æ”¹è¿›æ•ˆæœ

### ç”¨æˆ·ä½“éªŒæå‡
- âœ… **ç©ºé—´ä¼˜åŒ–** - æŒ‰é’®ç›´æ¥é›†æˆåœ¨ Dev Server bar ä¸­ï¼ŒèŠ‚çœç•Œé¢ç©ºé—´
- âœ… **è§†è§‰ç»Ÿä¸€** - å›¾æ ‡æŒ‰é’®ä¸ ToolBlock çš„è®¾è®¡é£æ ¼ä¸€è‡´
- âœ… **é€»è¾‘æ¸…æ™°** - ç›¸å…³æ“ä½œé›†ä¸­åœ¨ä¸€ä¸ªåœ°æ–¹ï¼Œé¿å…åˆ†æ•£
- âœ… **å¿«é€Ÿæ“ä½œ** - å›¾æ ‡æŒ‰é’®æ›´ç´§å‡‘ï¼Œç‚¹å‡»æ›´æ–¹ä¾¿

### æŠ€æœ¯ä¼˜åŠ¿
- âœ… **åŸç”Ÿå…¼å®¹** - ä½¿ç”¨åŸç”Ÿçš„ `vscode.postMessage` å’Œ `askResponse` é€»è¾‘
- âœ… **ä»£æ›¿å…³ç³»** - æ˜ç¡®çš„ä»£æ›¿è€Œéå…±å­˜ï¼Œé¿å…é‡å¤æŒ‰é’®
- âœ… **äº‹ä»¶éš”ç¦»** - ä½¿ç”¨ `stopPropagation()` é˜²æ­¢è§¦å‘ ToolBlock å±•å¼€/æŠ˜å 
- âœ… **æ¡ä»¶æ¸²æŸ“** - åªåœ¨ `approvalState === "pending"` æ—¶æ˜¾ç¤ºæŒ‰é’®

## ğŸ“‹ æ–‡ä»¶ä¿®æ”¹æ¸…å•

| æ–‡ä»¶è·¯å¾„ | ä¿®æ”¹ç±»å‹ | æè¿° |
|---------|---------|------|
| `webview-ui-vite/src/components/chat-row/chat-tools.tsx` | åŠŸèƒ½æ‰©å±• | æ·»åŠ  customActions æ”¯æŒå’Œ DevServerToolBlock å›¾æ ‡æŒ‰é’® |
| `webview-ui-vite/src/components/chat-view/button-section.tsx` | é€»è¾‘ä¿®æ”¹ | æ’é™¤ Run Server æŒ‰é’®æ˜¾ç¤º |

## ğŸ” å…³é”®æŠ€æœ¯ç‚¹

### 1. æ¶ˆæ¯é€šä¿¡
```typescript
// ä½¿ç”¨åŸç”Ÿ VSCode æ¶ˆæ¯ç³»ç»Ÿ
vscode.postMessage({
  type: "askResponse",
  askResponse: "yesButtonTapped", // æˆ– "noButtonTapped"
  text: "",
  images: []
})
```

### 2. äº‹ä»¶å¤„ç†
```typescript
// é˜²æ­¢æŒ‰é’®ç‚¹å‡»è§¦å‘ ToolBlock å±•å¼€/æŠ˜å 
<div onClick={(e) => e.stopPropagation()}>
  {customActions}
</div>
```

## ğŸ§ª æµ‹è¯•éªŒè¯

### åŠŸèƒ½æµ‹è¯•
- [x] Dev Server å·¥å…·æ˜¾ç¤ºå›¾æ ‡æŒ‰é’®
- [x] Run Server æŒ‰é’®æ­£å¸¸å·¥ä½œ
- [x] Cancel æŒ‰é’®æ­£å¸¸å·¥ä½œ
- [x] è¾“å…¥åŒºåŸŸä¸å†æ˜¾ç¤º Dev Server æŒ‰é’®
- [x] å…¶ä»–å·¥å…·æŒ‰é’®ä¸å—å½±å“

## ğŸ“ ç»´æŠ¤è¯´æ˜

### æ‰©å±•å…¶ä»–å·¥å…·
å¦‚éœ€ä¸ºå…¶ä»–å·¥å…·æ·»åŠ ç±»ä¼¼çš„å›¾æ ‡æŒ‰é’®ï¼š

1. åœ¨å¯¹åº”çš„ ToolBlock ç»„ä»¶ä¸­å®ç° `renderActionButtons()` å‡½æ•°
2. ä½¿ç”¨ `customActions={renderActionButtons()}` ä¼ é€’ç»™ ToolBlock
3. åœ¨ ButtonSection ä¸­æ·»åŠ ç›¸åº”çš„æ’é™¤é€»è¾‘

### ä¿®æ”¹æŒ‰é’®æ ·å¼
ä¿®æ”¹ `renderActionButtons()` å‡½æ•°ä¸­çš„ Button ç»„ä»¶æ ·å¼ï¼š
- `className`: è°ƒæ•´æŒ‰é’®å¤§å°å’Œæ ·å¼
- `variant`: æ”¹å˜æŒ‰é’®å˜ä½“ï¼ˆdefault, outline, ghost ç­‰ï¼‰
- å›¾æ ‡: æ›¿æ¢ `<Play>` å’Œ `<X>` ä¸ºå…¶ä»– Lucide å›¾æ ‡

## ğŸ‰ é¡¹ç›®æˆæœ

æˆåŠŸå®ç°äº† Dev Server æŒ‰é’®çš„å›¾æ ‡åŒ–æ”¹è¿›ï¼Œæå‡äº†ç”¨æˆ·ç•Œé¢çš„æ•´æ´æ€§å’Œæ“ä½œä¾¿åˆ©æ€§ï¼ŒåŒæ—¶ä¿æŒäº†ä¸ç°æœ‰æ¡†æ¶çš„å®Œå…¨å…¼å®¹æ€§ã€‚è¿™ä¸ªæ”¹è¿›ä¸ºåç»­å…¶ä»–å·¥å…·çš„ç±»ä¼¼ä¼˜åŒ–æä¾›äº†å¯å¤ç”¨çš„æŠ€æœ¯æ–¹æ¡ˆã€‚

---

**å®Œæˆæ—¥æœŸ**: 2025-08-14  
**æ”¹è¿›ç±»å‹**: UI/UX ä¼˜åŒ–  
**å½±å“èŒƒå›´**: Dev Server å·¥å…·ç•Œé¢  
**å…¼å®¹æ€§**: å®Œå…¨å‘åå…¼å®¹
