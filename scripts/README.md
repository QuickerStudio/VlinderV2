# å‘å¸ƒè„šæœ¬

æœ¬ç›®å½•åŒ…å«ç”¨äºç®€åŒ– Vlinder æ‰©å±•å‘å¸ƒæµç¨‹çš„è„šæœ¬ã€‚

## ğŸ“‹ è„šæœ¬åˆ—è¡¨

### `release.sh` (Linux/macOS)

è‡ªåŠ¨åŒ–å‘å¸ƒæµç¨‹çš„ Bash è„šæœ¬ã€‚

**åŠŸèƒ½ï¼š**
- âœ… è‡ªåŠ¨æ›´æ–° package.json ç‰ˆæœ¬å·
- âœ… åˆ›å»º Git æäº¤
- âœ… åˆ›å»º Git æ ‡ç­¾
- âœ… æ¨é€åˆ°è¿œç¨‹ä»“åº“
- âœ… æ”¯æŒæ­£å¼ç‰ˆã€Beta ç‰ˆã€Alpha ç‰ˆ

### `release.bat` (Windows)

Windows ç‰ˆæœ¬çš„å‘å¸ƒè„šæœ¬ï¼ŒåŠŸèƒ½ä¸ `release.sh` ç›¸åŒã€‚

---

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### Linux/macOS

```bash
# å‘å¸ƒæ­£å¼ç‰ˆæœ¬ï¼ˆä¼šå‘å¸ƒåˆ° Marketplaceï¼‰
./scripts/release.sh 3.7.22 release

# å‘å¸ƒ Beta ç‰ˆæœ¬ï¼ˆä¸ä¼šå‘å¸ƒåˆ° Marketplaceï¼‰
./scripts/release.sh 3.7.22 beta

# å‘å¸ƒ Alpha ç‰ˆæœ¬ï¼ˆä¸ä¼šå‘å¸ƒåˆ° Marketplaceï¼‰
./scripts/release.sh 3.7.22 alpha
```

### Windows

```cmd
REM å‘å¸ƒæ­£å¼ç‰ˆæœ¬ï¼ˆä¼šå‘å¸ƒåˆ° Marketplaceï¼‰
scripts\release.bat 3.7.22 release

REM å‘å¸ƒ Beta ç‰ˆæœ¬ï¼ˆä¸ä¼šå‘å¸ƒåˆ° Marketplaceï¼‰
scripts\release.bat 3.7.22 beta

REM å‘å¸ƒ Alpha ç‰ˆæœ¬ï¼ˆä¸ä¼šå‘å¸ƒåˆ° Marketplaceï¼‰
scripts\release.bat 3.7.22 alpha
```

---

## ğŸ“ å‚æ•°è¯´æ˜

### ç‰ˆæœ¬å·ï¼ˆå¿…éœ€ï¼‰

æ ¼å¼ï¼š`X.Y.Z`ï¼ˆä¾‹å¦‚ï¼š`3.7.22`ï¼‰

- `X` - ä¸»ç‰ˆæœ¬å·ï¼ˆé‡å¤§æ›´æ–°ï¼‰
- `Y` - æ¬¡ç‰ˆæœ¬å·ï¼ˆæ–°åŠŸèƒ½ï¼‰
- `Z` - ä¿®è®¢å·ï¼ˆBug ä¿®å¤ï¼‰

### å‘å¸ƒç±»å‹ï¼ˆå¯é€‰ï¼Œé»˜è®¤ï¼šreleaseï¼‰

| ç±»å‹ | è¯´æ˜ | Git æ ‡ç­¾ | å‘å¸ƒåˆ° Marketplace |
|------|------|---------|-------------------|
| `release` | æ­£å¼ç‰ˆæœ¬ | `vX.Y.Z` | âœ… æ˜¯ |
| `beta` | æµ‹è¯•ç‰ˆæœ¬ | `vX.Y.Z-beta.1` | âŒ å¦ |
| `alpha` | é¢„è§ˆç‰ˆæœ¬ | `vX.Y.Z-alpha.1` | âŒ å¦ |

---

## ğŸ”„ è„šæœ¬æ‰§è¡Œæµç¨‹

1. **éªŒè¯å‚æ•°**
   - æ£€æŸ¥ç‰ˆæœ¬å·æ ¼å¼
   - æ£€æŸ¥å‘å¸ƒç±»å‹

2. **æ£€æŸ¥ç¯å¢ƒ**
   - ç¡®è®¤åœ¨ Git ä»“åº“ä¸­
   - æ£€æŸ¥æ˜¯å¦æœ‰æœªæäº¤çš„æ›´æ”¹

3. **æ›´æ–°ç‰ˆæœ¬å·**
   - ä¿®æ”¹ `extension/package.json` ä¸­çš„ `version` å­—æ®µ

4. **æäº¤æ›´æ”¹**
   - åˆ›å»ºæäº¤ï¼š`chore: bump version to X.Y.Z`

5. **åˆ›å»ºæ ‡ç­¾**
   - æ ¹æ®å‘å¸ƒç±»å‹åˆ›å»ºç›¸åº”çš„ Git æ ‡ç­¾

6. **æ¨é€åˆ°è¿œç¨‹**
   - æ¨é€å½“å‰åˆ†æ”¯
   - æ¨é€æ–°åˆ›å»ºçš„æ ‡ç­¾

7. **è§¦å‘ GitHub Actions**
   - æ ‡ç­¾æ¨é€åè‡ªåŠ¨è§¦å‘ Release å·¥ä½œæµ

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### ä½¿ç”¨å‰æ£€æŸ¥

- [ ] ç¡®ä¿æ‰€æœ‰æ›´æ”¹å·²æäº¤
- [ ] ç¡®ä¿åœ¨æ­£ç¡®çš„åˆ†æ”¯ä¸Šï¼ˆé€šå¸¸æ˜¯ `main` æˆ– `master`ï¼‰
- [ ] ç¡®ä¿æœ¬åœ°ä»£ç ä¸è¿œç¨‹åŒæ­¥
- [ ] ç¡®ä¿å·²æ›´æ–° CHANGELOG.md

### ç‰ˆæœ¬å·è§„èŒƒ

éµå¾ª [è¯­ä¹‰åŒ–ç‰ˆæœ¬](https://semver.org/lang/zh-CN/) è§„èŒƒï¼š

- **ä¸»ç‰ˆæœ¬å·ï¼ˆXï¼‰**ï¼šä¸å…¼å®¹çš„ API ä¿®æ”¹
- **æ¬¡ç‰ˆæœ¬å·ï¼ˆYï¼‰**ï¼šå‘ä¸‹å…¼å®¹çš„åŠŸèƒ½æ€§æ–°å¢
- **ä¿®è®¢å·ï¼ˆZï¼‰**ï¼šå‘ä¸‹å…¼å®¹çš„é—®é¢˜ä¿®æ­£

### å‘å¸ƒç±»å‹é€‰æ‹©

- **æ­£å¼ç‰ˆæœ¬ï¼ˆreleaseï¼‰**ï¼š
  - ç”¨äºç”Ÿäº§ç¯å¢ƒ
  - ä¼šè‡ªåŠ¨å‘å¸ƒåˆ° VS Code Marketplace
  - éœ€è¦ç¡®ä¿å·²é…ç½® `VSCE_TOKEN` å’Œ `OVSX_TOKEN`

- **Beta ç‰ˆæœ¬ï¼ˆbetaï¼‰**ï¼š
  - ç”¨äºå…¬å¼€æµ‹è¯•
  - åªå‘å¸ƒåˆ° GitHub Release
  - ä¸ä¼šå‘å¸ƒåˆ° Marketplace

- **Alpha ç‰ˆæœ¬ï¼ˆalphaï¼‰**ï¼š
  - ç”¨äºå†…éƒ¨æµ‹è¯•
  - åªå‘å¸ƒåˆ° GitHub Release
  - ä¸ä¼šå‘å¸ƒåˆ° Marketplace

---

## ğŸ› ï¸ æ•…éšœæ’æŸ¥

### è„šæœ¬æ‰§è¡Œå¤±è´¥

**é—®é¢˜ï¼š** æç¤º "Permission denied"

**è§£å†³æ–¹æ¡ˆï¼ˆLinux/macOSï¼‰ï¼š**
```bash
chmod +x scripts/release.sh
```

---

**é—®é¢˜ï¼š** æç¤º "not a git repository"

**è§£å†³æ–¹æ¡ˆï¼š**
ç¡®ä¿åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œè„šæœ¬ï¼š
```bash
cd /path/to/Vlinder
./scripts/release.sh 3.7.22 release
```

---

**é—®é¢˜ï¼š** æç¤º "uncommitted changes"

**è§£å†³æ–¹æ¡ˆï¼š**
æäº¤æˆ–æš‚å­˜æ‰€æœ‰æ›´æ”¹ï¼š
```bash
git add .
git commit -m "your commit message"
```

---

**é—®é¢˜ï¼š** æç¤º "tag already exists"

**è§£å†³æ–¹æ¡ˆï¼š**
åˆ é™¤å·²å­˜åœ¨çš„æ ‡ç­¾ï¼š
```bash
# åˆ é™¤æœ¬åœ°æ ‡ç­¾
git tag -d v3.7.22

# åˆ é™¤è¿œç¨‹æ ‡ç­¾ï¼ˆå¦‚æœå·²æ¨é€ï¼‰
git push origin :refs/tags/v3.7.22
```

---

### æ¨é€å¤±è´¥

**é—®é¢˜ï¼š** æ¨é€åˆ°è¿œç¨‹ä»“åº“å¤±è´¥

**è§£å†³æ–¹æ¡ˆï¼š**
1. æ£€æŸ¥ç½‘ç»œè¿æ¥
2. æ£€æŸ¥ Git å‡­æ®
3. æ£€æŸ¥æ˜¯å¦æœ‰æ¨é€æƒé™

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [å¿«é€Ÿå¼€å§‹æŒ‡å—](../.github/QUICKSTART.md)
- [Marketplace é…ç½®](../.github/MARKETPLACE_SETUP.md)
- [å·¥ä½œæµæ–‡æ¡£](../.github/workflows/README.md)

---

## ğŸ’¡ æœ€ä½³å®è·µ

1. **å‘å¸ƒå‰æµ‹è¯•**
   ```bash
   cd extension
   pnpm run build
   pnpm run test
   ```

2. **å…ˆå‘å¸ƒ Beta ç‰ˆæœ¬**
   ```bash
   ./scripts/release.sh 3.7.22 beta
   # æµ‹è¯•æ— è¯¯åå†å‘å¸ƒæ­£å¼ç‰ˆ
   ./scripts/release.sh 3.7.22 release
   ```

3. **ä¿æŒ CHANGELOG æ›´æ–°**
   åœ¨è¿è¡Œè„šæœ¬å‰ï¼Œå…ˆæ›´æ–° `CHANGELOG.md`

4. **ä½¿ç”¨è¯­ä¹‰åŒ–ç‰ˆæœ¬**
   - Bug ä¿®å¤ï¼š`3.7.22` â†’ `3.7.23`
   - æ–°åŠŸèƒ½ï¼š`3.7.22` â†’ `3.8.0`
   - é‡å¤§æ›´æ–°ï¼š`3.7.22` â†’ `4.0.0`

---

## ğŸ”— æ‰‹åŠ¨å‘å¸ƒ

å¦‚æœä½ ä¸æƒ³ä½¿ç”¨è„šæœ¬ï¼Œå¯ä»¥æ‰‹åŠ¨æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
# 1. æ›´æ–°ç‰ˆæœ¬å·ï¼ˆæ‰‹åŠ¨ç¼–è¾‘ extension/package.jsonï¼‰

# 2. æäº¤æ›´æ”¹
git add extension/package.json
git commit -m "chore: bump version to 3.7.22"

# 3. åˆ›å»ºæ ‡ç­¾
git tag -a v3.7.22 -m "Release v3.7.22"

# 4. æ¨é€
git push origin main
git push origin v3.7.22
```

---

**æç¤ºï¼š** è„šæœ¬ä¼šåœ¨æ¯ä¸ªå…³é”®æ­¥éª¤å‰è¯·æ±‚ç¡®è®¤ï¼Œä½ å¯ä»¥éšæ—¶å–æ¶ˆæ“ä½œã€‚

