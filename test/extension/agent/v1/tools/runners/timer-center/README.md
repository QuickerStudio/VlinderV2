# Timer Center æµ‹è¯•å¥—ä»¶

Timer å·¥å…·çš„å®Œæ•´æµ‹è¯•å¥—ä»¶ï¼ŒåŒ…å«å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•å’Œç«¯åˆ°ç«¯æµ‹è¯•ã€‚

## ğŸ“ æµ‹è¯•æ–‡ä»¶ç»“æ„

```
timer-center/
â”œâ”€â”€ timer-context.test.ts      # TimerContext å•å…ƒæµ‹è¯•
â”œâ”€â”€ timer-manager.test.ts      # TimerManager å•å…ƒæµ‹è¯•
â”œâ”€â”€ timer.tool.test.ts         # Timer å·¥å…·æµ‹è¯•
â”œâ”€â”€ read-timer.tool.test.ts    # Read Timer å·¥å…·æµ‹è¯•
â”œâ”€â”€ stop-timer.tool.test.ts    # Stop Timer å·¥å…·æµ‹è¯•
â”œâ”€â”€ cancel-timer.tool.test.ts  # Cancel Timer å·¥å…·æµ‹è¯•
â”œâ”€â”€ pause-timer.tool.test.ts   # Pause Timer å·¥å…·æµ‹è¯•
â”œâ”€â”€ resume-timer.tool.test.ts  # Resume Timer å·¥å…·æµ‹è¯•
â”œâ”€â”€ integration.test.ts        # é›†æˆæµ‹è¯•
â”œâ”€â”€ run-tests.sh               # æµ‹è¯•è¿è¡Œè„šæœ¬
â””â”€â”€ README.md                  # æœ¬æ–‡ä»¶
```

## ğŸ¯ æµ‹è¯•è¦†ç›–èŒƒå›´

### 1. ç®¡ç†å™¨å±‚æµ‹è¯•

#### TimerContext æµ‹è¯• (`timer-context.test.ts`)
- âœ… åˆ›å»ºè®¡æ—¶å™¨ï¼ˆç­‰å¾…å‹/ä»»åŠ¡å‹ï¼‰
- âœ… ç­‰å¾…è¶…æ—¶æœºåˆ¶
- âœ… å‰©ä½™æ—¶é—´è®¡ç®—
- âœ… æš‚åœ/æ¢å¤åŠŸèƒ½
- âœ… å–æ¶ˆç­‰å¾…åŠŸèƒ½
- âœ… åœæ­¢è®¡æ—¶å™¨
- âœ… å®Œæˆå›è°ƒ
- âœ… çŠ¶æ€ä¿¡æ¯æŸ¥è¯¢
- âœ… è¾¹ç•Œæ¡ä»¶å¤„ç†
- âœ… å¹¶å‘æ“ä½œ

#### TimerManager æµ‹è¯• (`timer-manager.test.ts`)
- âœ… å•ä¾‹æ¨¡å¼
- âœ… åˆ›å»ºè®¡æ—¶å™¨ï¼ˆç­‰å¾…å‹/ä»»åŠ¡å‹ï¼‰
- âœ… æŸ¥è¯¢è®¡æ—¶å™¨ï¼ˆå•ä¸ª/æ‰€æœ‰ï¼‰
- âœ… åœæ­¢è®¡æ—¶å™¨
- âœ… å–æ¶ˆç­‰å¾…
- âœ… æš‚åœ/æ¢å¤
- âœ… å®Œæˆå›è°ƒ
- âœ… è¾¹ç•Œæ¡ä»¶
- âœ… å¹¶å‘ç®¡ç†
- âœ… å†…å­˜ç®¡ç†

### 2. å·¥å…·å±‚æµ‹è¯•

#### Timer å·¥å…·æµ‹è¯• (`timer.tool.test.ts`)
- âœ… åˆ›å»ºç­‰å¾…å‹è®¡æ—¶å™¨
- âœ… åˆ›å»ºä»»åŠ¡å‹è®¡æ—¶å™¨
- âœ… ç»§ç»­ç°æœ‰è®¡æ—¶å™¨
- âœ… å‚æ•°éªŒè¯
- âœ… å·¥å…·è¾“å‡ºæ ¼å¼
- âœ… é”™è¯¯å¤„ç†
- âœ… è¾¹ç•Œæ¡ä»¶
- âœ… çŠ¶æ€åé¦ˆ

#### Read Timer å·¥å…·æµ‹è¯• (`read-timer.tool.test.ts`)
- âœ… æŸ¥è¯¢ç‰¹å®šè®¡æ—¶å™¨
- âœ… æŸ¥è¯¢æ‰€æœ‰è®¡æ—¶å™¨
- âœ… ä¸åŒçŠ¶æ€çš„è®¡æ—¶å™¨
- âœ… è¾“å‡ºæ ¼å¼éªŒè¯
- âœ… é”™è¯¯å¤„ç†
- âœ… è¾¹ç•Œæ¡ä»¶

#### Stop Timer å·¥å…·æµ‹è¯• (`stop-timer.tool.test.ts`)
- âœ… åœæ­¢è¿è¡Œä¸­çš„è®¡æ—¶å™¨
- âœ… åœæ­¢ä¸åŒçŠ¶æ€çš„è®¡æ—¶å™¨
- âœ… è¾“å‡ºæ ¼å¼éªŒè¯
- âœ… é”™è¯¯å¤„ç†

#### Cancel Timer å·¥å…·æµ‹è¯• (`cancel-timer.tool.test.ts`)
- âœ… å–æ¶ˆç­‰å¾…
- âœ… åå°è¿è¡ŒéªŒè¯
- âœ… è¾“å‡ºæ ¼å¼éªŒè¯
- âœ… é”™è¯¯å¤„ç†

#### Pause Timer å·¥å…·æµ‹è¯• (`pause-timer.tool.test.ts`)
- âœ… æš‚åœè®¡æ—¶å™¨
- âœ… è‡ªåŠ¨æ¢å¤éªŒè¯
- âœ… è¾“å‡ºæ ¼å¼éªŒè¯
- âœ… é”™è¯¯å¤„ç†

#### Resume Timer å·¥å…·æµ‹è¯• (`resume-timer.tool.test.ts`)
- âœ… æ¢å¤æš‚åœçš„è®¡æ—¶å™¨
- âœ… çŠ¶æ€éªŒè¯
- âœ… è¾“å‡ºæ ¼å¼éªŒè¯
- âœ… é”™è¯¯å¤„ç†

### 3. é›†æˆæµ‹è¯• (`integration.test.ts`)

#### ç­‰å¾…å‹Timerå®Œæ•´æµç¨‹
- âœ… åˆ›å»º â†’ æŸ¥è¯¢ â†’ åœæ­¢
- âœ… åˆ›å»º â†’ æš‚åœ â†’ æ¢å¤ â†’ åœæ­¢
- âœ… åˆ›å»º â†’ å–æ¶ˆç­‰å¾… â†’ æŸ¥è¯¢

#### ä»»åŠ¡å‹Timerå®Œæ•´æµç¨‹
- âœ… åˆ›å»ºä»»åŠ¡å‹è®¡æ—¶å™¨å¹¶æŸ¥è¯¢

#### å¤šè®¡æ—¶å™¨å¹¶å‘æµ‹è¯•
- âœ… åŒæ—¶ç®¡ç†å¤šä¸ªè®¡æ—¶å™¨
- âœ… ç‹¬ç«‹æ“ä½œä¸åŒè®¡æ—¶å™¨

#### é”™è¯¯æ¢å¤æµ‹è¯•
- âœ… ä»é”™è¯¯ä¸­æ¢å¤

## ğŸš€ è¿è¡Œæµ‹è¯•

### è¿è¡Œæ‰€æœ‰æµ‹è¯•

```bash
# ä½¿ç”¨æµ‹è¯•è„šæœ¬
cd test/extension/agent/v1/tools/runners/timer-center
chmod +x run-tests.sh
./run-tests.sh

# æˆ–ä½¿ç”¨ npm/pnpm
cd extension
pnpm test timer-center
```

### è¿è¡Œå•ä¸ªæµ‹è¯•æ–‡ä»¶

```bash
# è¿è¡Œ TimerManager æµ‹è¯•
npx jest test/extension/agent/v1/tools/runners/timer-center/timer-manager.test.ts

# è¿è¡Œ Timer å·¥å…·æµ‹è¯•
npx jest test/extension/agent/v1/tools/runners/timer-center/timer.tool.test.ts

# è¿è¡Œé›†æˆæµ‹è¯•
npx jest test/extension/agent/v1/tools/runners/timer-center/integration.test.ts
```

### è¿è¡Œç‰¹å®šæµ‹è¯•ç”¨ä¾‹

```bash
# è¿è¡Œç‰¹å®šæè¿°çš„æµ‹è¯•
npx jest -t "åº”è¯¥æˆåŠŸåˆ›å»ºç­‰å¾…å‹è®¡æ—¶å™¨"

# è¿è¡Œç‰¹å®šæ–‡ä»¶çš„ç‰¹å®šæµ‹è¯•
npx jest timer-manager.test.ts -t "å•ä¾‹æ¨¡å¼"
```

### æŸ¥çœ‹æµ‹è¯•è¦†ç›–ç‡

```bash
npx jest --coverage test/extension/agent/v1/tools/runners/timer-center/
```

## ğŸ“Š æµ‹è¯•ç»Ÿè®¡

### æµ‹è¯•æ•°é‡
- **ç®¡ç†å™¨å±‚**: ~50 ä¸ªæµ‹è¯•ç”¨ä¾‹
- **å·¥å…·å±‚**: ~60 ä¸ªæµ‹è¯•ç”¨ä¾‹
- **é›†æˆæµ‹è¯•**: ~10 ä¸ªæµ‹è¯•ç”¨ä¾‹
- **æ€»è®¡**: ~120 ä¸ªæµ‹è¯•ç”¨ä¾‹

### è¦†ç›–èŒƒå›´
- **ä»£ç è¦†ç›–ç‡ç›®æ ‡**: > 90%
- **åˆ†æ”¯è¦†ç›–ç‡ç›®æ ‡**: > 85%
- **å‡½æ•°è¦†ç›–ç‡ç›®æ ‡**: > 95%

## ğŸ” æµ‹è¯•é‡ç‚¹

### 1. åŠŸèƒ½æ­£ç¡®æ€§
- è®¡æ—¶å™¨åˆ›å»ºå’Œç®¡ç†
- æ—¶é—´è®¡ç®—å‡†ç¡®æ€§
- çŠ¶æ€è½¬æ¢æ­£ç¡®æ€§
- å·¥å…·è¾“å‡ºæ ¼å¼

### 2. é”™è¯¯å¤„ç†
- æ— æ•ˆå‚æ•°å¤„ç†
- ä¸å­˜åœ¨çš„è®¡æ—¶å™¨
- å¼‚å¸¸æƒ…å†µæ¢å¤
- è¾¹ç•Œæ¡ä»¶

### 3. æ€§èƒ½æµ‹è¯•
- å¹¶å‘è®¡æ—¶å™¨ç®¡ç†
- å†…å­˜æ³„æ¼æ£€æµ‹
- é•¿æ—¶é—´è¿è¡Œç¨³å®šæ€§

### 4. é›†æˆæµ‹è¯•
- å·¥å…·é—´åä½œ
- å®Œæ•´å·¥ä½œæµç¨‹
- çŠ¶æ€ä¸€è‡´æ€§

## ğŸ› å·²çŸ¥é—®é¢˜å’Œä¿®å¤è®¡åˆ’

### å½“å‰é—®é¢˜
1. âš ï¸ é•¿æ—¶é—´è®¡æ—¶å™¨ï¼ˆ>1å°æ—¶ï¼‰æœªå……åˆ†æµ‹è¯•
2. âš ï¸ ç³»ç»Ÿæ¶ˆæ¯é€šçŸ¥åŠŸèƒ½æœªå®ç°
3. âš ï¸ å‰ç«¯UIç»„ä»¶æµ‹è¯•ç¼ºå¤±

### ä¿®å¤è®¡åˆ’
1. æ·»åŠ é•¿æ—¶é—´è®¡æ—¶å™¨æµ‹è¯•
2. å®ç°ç³»ç»Ÿæ¶ˆæ¯é€šçŸ¥å¹¶æ·»åŠ æµ‹è¯•
3. åˆ›å»ºå‰ç«¯ç»„ä»¶æµ‹è¯•
4. æ·»åŠ æ€§èƒ½åŸºå‡†æµ‹è¯•

## ğŸ“ æµ‹è¯•æœ€ä½³å®è·µ

### 1. æµ‹è¯•éš”ç¦»
- æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹ç‹¬ç«‹è¿è¡Œ
- ä½¿ç”¨ `beforeEach` å’Œ `afterEach` æ¸…ç†çŠ¶æ€
- é¿å…æµ‹è¯•é—´çš„ä¾èµ–

### 2. Mock ä½¿ç”¨
- Mock å¤–éƒ¨ä¾èµ–ï¼ˆvscode APIç­‰ï¼‰
- ä¿æŒ Mock ç®€å•å’Œå¯ç»´æŠ¤
- éªŒè¯ Mock è°ƒç”¨

### 3. å¼‚æ­¥æµ‹è¯•
- ä½¿ç”¨ `async/await` å¤„ç†å¼‚æ­¥æ“ä½œ
- è®¾ç½®åˆç†çš„è¶…æ—¶æ—¶é—´
- æ¸…ç†å¼‚æ­¥èµ„æº

### 4. æ–­è¨€æ¸…æ™°
- ä½¿ç”¨æè¿°æ€§çš„æ–­è¨€æ¶ˆæ¯
- ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹æµ‹è¯•ä¸€ä¸ªåŠŸèƒ½ç‚¹
- é¿å…è¿‡åº¦æ–­è¨€

## ğŸ”§ è°ƒè¯•æµ‹è¯•

### è¿è¡Œå•ä¸ªæµ‹è¯•å¹¶æŸ¥çœ‹è¯¦ç»†è¾“å‡º

```bash
npx jest timer-manager.test.ts --verbose
```

### è°ƒè¯•æ¨¡å¼è¿è¡Œ

```bash
node --inspect-brk node_modules/.bin/jest timer-manager.test.ts
```

### æŸ¥çœ‹å¤±è´¥æµ‹è¯•çš„è¯¦ç»†ä¿¡æ¯

```bash
npx jest --verbose --no-coverage
```

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [Timer Center README](../../../../../../../extension/src/agent/v1/tools/runners/timer-center/README.md)
- [Timer è®¾è®¡æ–‡æ¡£](../../../../../../../docs/TIMER_TOOL_IMPROVEMENT.md)
- [Jest æ–‡æ¡£](https://jestjs.io/docs/getting-started)

